---
title: "Package development."
subtitle: "Creating impact from code."
author: "Emma Rand and Susannah Cowtan."
institute: "Forwards"
date: "updated: `r Sys.Date()`"
about:
  license_file: LICENSE
output:
  xaringan::moon_reader:
    seal: false
    css: [default, emma.css, emma-fonts.css]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: true

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE,	
                      warning = FALSE)
options(htmltools.dir.version = FALSE)
```

```{r pkgs, include=FALSE}
library(RefManageR)
library(tidyverse)

```

```{r, load-refs, include=FALSE, cache=FALSE}
BibOptions(check.entries = FALSE,
           bib.style = "numeric",
           cite.style = "authoryear",
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)
myBib <- ReadBib("bibliography.bib", check = FALSE)
```

background-image: url(pics/forwards.svg)
background-position: 50% 65%
background-size: 250px

class: inverse

# Package development.

## Creating impact from code.

### Emma Rand and Susannah Cowtan. 

### York January 2020.

Updated: `r Sys.Date()`

.footnote[
[1] Made with xaringan `r Cite(myBib, "xaringan")`

]
---
background-image: url(pics/forwards.svg)
background-position: 50% 55%
background-size: 250px

class: inverse center

# Git and GitHub.

.center[
## `r emo::ji("runner")` A very brief guide!
]
---

# Git and GitHub.

## What is Git?
Git is a version control system:

* monitors the changes made to files.
* changes to your code are tracked and can be shared.
* to commit means to save a version.

## What is GitHub??

GitHub is a website that hosts Git projects. 

---

# Git and GitHub.

## Why use Git and GitHub.

* collaborate on code more easily.
* share your code with the world.
* allow others to install your packages.
* have a package website.
* track 'issues'.
* have others suggest improvements via pull requests.

Git and GitHub are generally useful for all software development and data analysis


---

# Git and GitHub.

## This workshop....

Is a very "bare bones" introduction that will give you a workflow for using Git and GitHub through RStudio.

--

A more thorough coverage of Git and GitHub through RStudio is [Happy Git and GitHub for the useR](https://happygitwithr.com/) `r Cite(myBib, "Bryan_Happy_Git")`.

--

You don't have to use RStudio to use Git. A more general guide is here https://towardsdatascience.com/getting-started-with-git-and-github-6fcd0f2d4ac6

---
# Git and GitHub.

## `use_github()`

We used `use_git()`<sup>1</sup> to make our project a Git repository, or 'repo'.

This is on our local machine. 

--

To create a copy on GitHub we use:

```{r eval=FALSE}
use_github()
```


This takes a local project, creates an associated repo on GitHub, adds it to your local repo as the "origin remote", and makes an initial "push" to synchronize. 

To use `use_github()` your project must already be a Git repository. 


.footnote[
[1] Used in [Package creation ](1_Package_creation.html).
]

---
# Git and GitHub.

## `use_github()`

You'll get an error:

```
Error: No GitHub `auth_token` is available.
See `browse_github_token()` for help storing a token as an environment variable.
```

because authentication is also required.

---
# Git and GitHub.

## Authentication

A new GitHub repo will be created via the GitHub API, therefore you must make a GitHub personal access token (PAT) available. You can do this with:

```{r eval=FALSE}
browse_github_token()
```

This opens a browser window for you to log in to GitHub. 

--

A page will open on GitHub.

Click generate token.

Copy it.

Leave this page open for the time being.

---
# Git and GitHub.

## Authentication

Go back to RStudio where you should see:

```
✔ Opening URL 'https://github.com/settings/tokens/new?scopes=repo,gist&description=R:GITHUB_PAT'
● Call `usethis::edit_r_environ()` to open '.Renviron'.
● Store your PAT with a line like:
  GITHUB_PAT=xxxyyyzzz
  [Copied to clipboard]
● Make sure '.Renviron' ends with a newline!
```

---
# Git and GitHub.

## Authentication

As instructed, do:

```{r eval=FALSE}
usethis::edit_r_environ()
```
```
● Modify '//userfs/er13/w2k/.Renviron'
● Restart R for changes to take effect

```

`.Renviron` will open. Add a line like:

```
GITHUB_PAT=xxxyyyzzz
```

Where xxxyyyzzz is pasted from the clipboard.

Make sure `.Renviron` ends with a newline!

Save and close `.Renviron`

---
# Git and GitHub.

## And we are ready!

Make sure you restart R as instructed. Then do:

```{r eval=FALSE}
library(devtools)
use_github() 
```

```
✔ Checking that current branch is 'master'
Which git protocol to use? (enter 0 to exit) 

1: ssh   <-- presumes that you have set up ssh keys
2: https <-- choose this if you don't have ssh keys (or don't know if you do)

```
Choose 2 at the moment.


---

# Git and GitHub.

## On using `use_github()`

 ```
 Selection: 2
● Tip: To suppress this menu in future, put
  `options(usethis.protocol = "https")`
  in your script or in a user- or project-level startup file, '.Rprofile'.
  Call `usethis::edit_r_profile()` to open it for editing.
● Check title and description
  Name:        mypackage
  Description: What the Package Does (One Line, Title Case)
Are title and description ok?

1: Not now
2: Absolutely not
3: Yup
 
 
 ```

Say yes for the time being.

In future, you might want amend documentation before your first commit to GitHub.

---

# Git and GitHub.

## On using `use_github()`

```
Selection: 3
✔ Creating GitHub repository
✔ Setting remote 'origin' to 'https://github.com/3mmaRand/mypackage.git'
✔ Adding GitHub links to DESCRIPTION
✔ Setting URL field in DESCRIPTION to 'https://github.com/3mmaRand/mypackage'
✔ Setting BugReports field in DESCRIPTION to 'https://github.com/3mmaRand/mypackage/issues'
✔ Pushing 'master' branch to GitHub and setting remote tracking branch
✔ Opening URL 'https://github.com/3mmaRand/mypackage'
 
 
```
--

## Now look at your GitHub page! `r emo::ji("party")` 

---
# References

```{r refs, echo=FALSE, results="asis"}
PrintBibliography(myBib)
```


---
# License

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Package Development: Creating impact from code.</span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">R Forwards</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
